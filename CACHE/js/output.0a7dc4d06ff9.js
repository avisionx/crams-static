$(".sideTab").on('click',(e)=>{$(e.target).children().click();});$(".content").on('click',()=>{$(".content").removeClass("show");$("#sidebar").removeClass("show");$(".hamburger").removeClass("is-active");});function toggleSidenav(){$(".hamburger").toggleClass("is-active");$(".content").toggleClass("show");$("#sidebar").toggleClass("show");}
fetchData("/api/notifs/",populateNotification);function populateNotification(notifs){if(notifs.data.length!=0){$("#notifDot").removeClass('d-none');for(var i=0;i<notifs.data.length;i++){var notifMsg=notifs.data[i].msg;var notifDate=notifs.data[i].created_at;var ele='<div class="dropdown-item notifDropDown-item small px-3"><p class="mb-1 text-wrap">'+
notifMsg+'</p><p class="mb-1 text-secondary small text-right">'+notifDate+'</p></div>';if(i==0){$("#notificationBox").html(ele);}else{$("#notificationBox").append(ele);}}}};var dataTable=null;var dataSem=null;var OFFERED_TO_CHOICES={1:'UG',2:'PG',3:'UG/PG'}
var SEM_CHOICES={1:'Monsoon',2:'Winter',3:'Summer'}
$(document).ready(()=>{dataSem=$("#semSearch")[0].value;populateTable(dataSem);var onLoadCourse=window.location.href.split("#")[1];if(onLoadCourse){showCourseInfo(onLoadCourse);}});function setCourseType(txt){$("#coursesTypeBtn").html(txt);}
$("#semSearch").on('change',function(){dataSem=this.value;populateTable(dataSem);});$('#searchBox').on('keyup',function(){dataTable.search(this.value).draw();});function populateTable(semester){if(semester){if(dataTable){dataTable.ajax.url("/api/courses/?q="+semester).load();}
else{dataTable=$("#courses-table").DataTable({"lengthMenu":[[10,25,50,-1],[10,25,50,"All"]],"language":{"emptyTable":"No courses found.","lengthMenu":"Show _MENU_ entries","loadingRecords":"Loading...","processing":"Processing...","zeroRecords":"No courses found."},"dom":"<'row'<'col-12'tr>>"+"<'row mt-1 small'<'col-12 col-lg-auto mr-auto v-center order-2 order-lg-1 mt-2 ml-1 ml-lg-0 mt-lg-0'l><'col-12 col-lg-auto order-1 order-lg-2'p>>","ajax":"/api/courses/?q="+semester,"columns":[{"data":"course_code","fnCreatedCell":function(nTd,sData,oData,iRow,iCol){$(nTd).html("<a href='#"+oData.slug+"' class='no-decoration courseLink' onclick='showCourseInfo(\""+oData.slug+"\")' >"+oData.course_code.replace("-","/")+"</a>");}},{"data":"course_name"},{"data":"instructor"},{"data":"course_credits"},{"data":"offered_to"},],});}}}
function showCourseInfo(slug){$(window).scrollTop(0);fetchData("/api/course/"+slug,populateCourseModal);$('body').addClass("no-scroll");$('html').addClass("no-scroll");$(".dashModalContainer").fadeIn();}
function populateCourseModal(course){var data=JSON.parse(course.data)[0]
courseName=data.fields.course_name;courseInstructor=data.fields.instructor;courseSem=SEM_CHOICES[data.fields.sem_offer];courseOffer=OFFERED_TO_CHOICES[data.fields.offered_to];courseCode=data.pk.replace("-","/");courseCredits=data.fields.course_credits;classroomLink=data.fields.classroom_link;courseType=course.creditType.toString().replace(",",", ")
preReq=data.fields.pre_reqs.length?'<p class="text-warning font-weight-light small mb-0">Pre Requisite: '+data.fields.pre_reqs+'</p>':"";antiReq=data.fields.anti_reqs.length?'<p class="text-danger font-weight-light small mb-0">Anti Requisite: '+data.fields.anti_reqs+'</p>':"";similarCourses=course.recommendations.length?'<h5 class="text-info font-weight-bold mt-2 mb-0 ">Similar Courses</h5>'+recommendationsList(course.recommendations):"";courseDesc=data.fields.course_description;courseEval="Quiz: x% Assignment: x% Midsem: x% Endsem: x%"
var ele='<div class="d-flex mb-1"><div class="col v-center"><h2 class="font-weight-bold mb-0 text-primary">'+courseName+'</h2></div><div class="col-auto v-center"><a href="'+classroomLink+'" target="_blank" class="btn btn-outline-success btn-sm rounded-pill mr-2"><i class="fas fa-chalkboard-teacher mr-0 mr-md-1"></i> <span class="d-none d-md-inline">Go To Classroom</span></a></div></div><div><span class="badge bg-success font-weight-light mr-2">'+courseSem+'</span><span class="badge bg-info font-weight-light mr-2">'+courseOffer+'</span></div><p class="font-weight-light small mb-0 mt-1">Course Code: '+courseCode+'</p><p class="font-weight-light small mb-0">Instructor: '+courseInstructor+'</p><p class="font-weight-light small mb-0">Credits: '+courseCredits+'</p><p class="font-weight-light small mb-0">Credit Type: <span class="text-uppercase">'+courseType+'</span></p>'+preReq+antiReq+'<h5 class="text-info font-weight-bold mt-2 mb-0 ">Description</h5><p class="mb-0">'+courseDesc+'</p>'+'<h5 class="text-info font-weight-bold mt-2 mb-0 ">Evaluation: </h5><p class="mb-0">'+courseEval+'</p>'+similarCourses
$("#courseModalContent").html(ele);$("#courseModalContent").removeClass("d-none");$("#courseModalSpinner").addClass("d-none");}
function recommendationsList(courses){var ele='<ul class="list-group list-group-flush small">';courses.forEach(course=>{ele+='<li class="list-group-item border-0 pt-1 pb-0 pl-1"><a class="text-info" href="/courses/#'+course.slug+'" onclick="showCourseInfo(\''+course.slug+'\')" >'+course.course_code+'</a> - '+course.course_name+'</li>';});return ele+'</ul>';}
function hideCourseInfo(event){event.preventDefault();history.replaceState(null,null,' ');$('body').removeClass("no-scroll");$('html').removeClass("no-scroll");$(".dashModalContainer").fadeOut(function(){$("#courseModalContent").addClass("d-none");$("#courseModalSpinner").removeClass("d-none");});}
$(document).on('keydown',function(event){if(event.key=="Escape"){hideCourseInfo(event);}});;